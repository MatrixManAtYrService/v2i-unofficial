# TMX CMakeFile v. 2.2

CMAKE_MINIMUM_REQUIRED(VERSION @CMAKE_MINIMUM_REQUIRED_VERSION@)

PROJECT(TMX-PLUGINS CXX)

SET(CMAKE_C_FLAGS "@CMAKE_C_FLAGS@")
SET(CMAKE_CXX_FLAGS "@CMAKE_CXX_FLAGS@")
SET(CMAKE_ARCHIVE_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/lib)
INCLUDE_DIRECTORIES(ivputils/src)
LINK_DIRECTORIES(${CMAKE_BINARY_DIR}/lib)
SET(CMAKE_MODULE_PATH "${CMAKE_MODULE_PATH}" "${CMAKE_BINARY_DIR}")

SET(CMAKE_BUILD_WITH_INSTALL_RPATH @CMAKE_BUILD_WITH_INSTALL_RPATH@)
SET(CMAKE_INSTALL_RPATH_USE_LINK_PATH @CMAKE_INSTALL_RPATH_USE_LINK_PATH@)

FIND_PACKAGE(Boost 1.55 COMPONENTS system thread atomic chrono log log_setup regex date_time REQUIRED)
ADD_DEFINITIONS(-DBOOST_ALL_DYN_LINK)

FIND_PATH(asn_j2735_INCLUDE_DIR asn_j2735_r41/BasicSafetyMessage.h)
FIND_LIBRARY(asn_j2735_LIBRARY NAMES asn_j2735_r41)     

FIND_PATH(ivpapi_INCLUDE_DIR ivp/IvpMessage.h)
FIND_LIBRARY(ivpapi_LIBRARY NAMES ivpapi)

ADD_SUBDIRECTORY(ivputils)

FILE(GLOB ALL_PLUGINS "*/CMakeLists.txt")
FOREACH(PLUGIN ${ALL_PLUGINS})
    GET_FILENAME_COMPONENT(PLUGINDIR ${PLUGIN} DIRECTORY)
    IF(NOT PLUGINDIR MATCHES ivputils)
        ADD_SUBDIRECTORY(${PLUGINDIR} ${PLUGINDIR})
    ENDIF()
ENDFOREACH()
